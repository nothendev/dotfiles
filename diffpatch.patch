diff --git a/.gitignore b/.gitignore
deleted file mode 100644
--- a/.gitignore
+++ /dev/null
@@ -1,11 +0,0 @@
-
-# Devenv
-.devenv*
-devenv.local.nix
-
-# direnv
-.direnv
-
-# pre-commit
-.pre-commit-config.yaml
-
diff --git a/.hgignore b/.hgignore
new file mode 100644
--- /dev/null
+++ b/.hgignore
@@ -0,0 +1,12 @@
+syntax: glob
+
+# Devenv
+.devenv*
+devenv.local.nix
+
+# direnv
+.direnv
+
+# pre-commit
+.pre-commit-config.yaml
+
diff --git a/flake.lock b/flake.lock
--- a/flake.lock
+++ b/flake.lock
@@ -3,11 +3,11 @@
     "catppuccin-alacritty": {
       "flake": false,
       "locked": {
-        "lastModified": 1708974882,
-        "narHash": "sha256-HiIYxTlif5Lbl9BAvPsnXp8WAexL8YuohMDd/eCJVQ8=",
+        "lastModified": 1712663324,
+        "narHash": "sha256-Pi1Hicv3wPALGgqurdTzXEzJNx7vVh+8B9tlqhRpR2Y=",
         "owner": "catppuccin",
         "repo": "alacritty",
-        "rev": "071d73effddac392d5b9b8cd5b4b527a6cf289f9",
+        "rev": "94800165c13998b600a9da9d29c330de9f28618e",
         "type": "github"
       },
       "original": {
@@ -89,11 +89,11 @@
         ]
       },
       "locked": {
-        "lastModified": 1708794349,
-        "narHash": "sha256-jX+B1VGHT0ruHHL5RwS8L21R6miBn4B6s9iVyUJsJJY=",
+        "lastModified": 1712681629,
+        "narHash": "sha256-bMDXn4AkTXLCpoZbII6pDGoSeSe9gI87jxPsHRXgu/E=",
         "owner": "ipetkov",
         "repo": "crane",
-        "rev": "2c94ff9a6fbeb9f3ea0107f28688edbe9c81deaa",
+        "rev": "220387ac8e99cbee0ca4c95b621c4bc782b6a235",
         "type": "github"
       },
       "original": {
@@ -104,7 +104,7 @@
     },
     "devshell": {
       "inputs": {
-        "flake-utils": "flake-utils_2",
+        "flake-utils": "flake-utils",
         "nixpkgs": [
           "nixvim",
           "nixpkgs"
@@ -150,19 +150,19 @@
     },
     "fjo": {
       "inputs": {
-        "flake-utils": "flake-utils",
         "nci": "nci",
         "nixpkgs": [
           "nixpkgs"
         ],
-        "parts": "parts_2"
+        "parts": "parts_2",
+        "treefmt": "treefmt_2"
       },
       "locked": {
-        "lastModified": 1710247246,
-        "narHash": "sha256-icWqYdd+/n+6hV+3qoi3HsmvjqaxBFfJPQsIjEZycLE=",
+        "lastModified": 1712212656,
+        "narHash": "sha256-c9j8xY4eG48DTTOYtaArsyNjpi3hLDtwv2xqfLYgS+w=",
         "ref": "refs/heads/main",
-        "rev": "21974f8d49f9b9bd282cadaec8c44250d0a3a5b3",
-        "revCount": 163,
+        "rev": "a6f7596debdca49cba964947c7ca2a1018a83819",
+        "revCount": 164,
         "type": "git",
         "url": "https://codeberg.org/VoiDD/fjo"
       },
@@ -240,11 +240,11 @@
         ]
       },
       "locked": {
-        "lastModified": 1709336216,
-        "narHash": "sha256-Dt/wOWeW6Sqm11Yh+2+t0dfEWxoMxGBvv3JpIocFl9E=",
+        "lastModified": 1712014858,
+        "narHash": "sha256-sB4SWl2lX95bExY2gMFG5HIzvva5AVMJd4Igm+GpZNw=",
         "owner": "hercules-ci",
         "repo": "flake-parts",
-        "rev": "f7b3c975cf067e56e7cda6cb098ebe3fb4d74ca2",
+        "rev": "9126214d0a59633752a136528f5f3b9aa8565b7d",
         "type": "github"
       },
       "original": {
@@ -277,14 +277,14 @@
     },
     "flake-utils": {
       "inputs": {
-        "systems": "systems"
+        "systems": "systems_3"
       },
       "locked": {
-        "lastModified": 1710146030,
-        "narHash": "sha256-SZ5L6eA7HJ/nmkzGG7/ISclqe6oZdOZTNoesiInkXPQ=",
+        "lastModified": 1701680307,
+        "narHash": "sha256-kAuep2h5ajznlPMD9rnQyffWG8EM/C73lejGofXvdM8=",
         "owner": "numtide",
         "repo": "flake-utils",
-        "rev": "b1d9ab70662946ef0850d488da1c9019f3a9752a",
+        "rev": "4022d587cbbfd70fe950c1e2083a02621806a725",
         "type": "github"
       },
       "original": {
@@ -298,11 +298,11 @@
         "systems": "systems_4"
       },
       "locked": {
-        "lastModified": 1701680307,
-        "narHash": "sha256-kAuep2h5ajznlPMD9rnQyffWG8EM/C73lejGofXvdM8=",
+        "lastModified": 1710146030,
+        "narHash": "sha256-SZ5L6eA7HJ/nmkzGG7/ISclqe6oZdOZTNoesiInkXPQ=",
         "owner": "numtide",
         "repo": "flake-utils",
-        "rev": "4022d587cbbfd70fe950c1e2083a02621806a725",
+        "rev": "b1d9ab70662946ef0850d488da1c9019f3a9752a",
         "type": "github"
       },
       "original": {
@@ -334,24 +334,6 @@
         "systems": "systems_6"
       },
       "locked": {
-        "lastModified": 1710146030,
-        "narHash": "sha256-SZ5L6eA7HJ/nmkzGG7/ISclqe6oZdOZTNoesiInkXPQ=",
-        "owner": "numtide",
-        "repo": "flake-utils",
-        "rev": "b1d9ab70662946ef0850d488da1c9019f3a9752a",
-        "type": "github"
-      },
-      "original": {
-        "owner": "numtide",
-        "repo": "flake-utils",
-        "type": "github"
-      }
-    },
-    "flake-utils_5": {
-      "inputs": {
-        "systems": "systems_7"
-      },
-      "locked": {
         "lastModified": 1701680307,
         "narHash": "sha256-kAuep2h5ajznlPMD9rnQyffWG8EM/C73lejGofXvdM8=",
         "owner": "numtide",
@@ -365,7 +347,7 @@
         "type": "github"
       }
     },
-    "flake-utils_6": {
+    "flake-utils_5": {
       "locked": {
         "lastModified": 1659877975,
         "narHash": "sha256-zllb8aq3YO3h8B/U0/J1WBgAL8EX5yWf5pMj3G0NAmc=",
@@ -380,16 +362,16 @@
         "type": "github"
       }
     },
-    "flake-utils_7": {
+    "flake-utils_6": {
       "inputs": {
-        "systems": "systems_8"
+        "systems": "systems_7"
       },
       "locked": {
-        "lastModified": 1709126324,
-        "narHash": "sha256-q6EQdSeUZOG26WelxqkmR7kArjgWCdw5sfJVHPH/7j8=",
+        "lastModified": 1710146030,
+        "narHash": "sha256-SZ5L6eA7HJ/nmkzGG7/ISclqe6oZdOZTNoesiInkXPQ=",
         "owner": "numtide",
         "repo": "flake-utils",
-        "rev": "d465f4819400de7c8d874d50b982301f28a84605",
+        "rev": "b1d9ab70662946ef0850d488da1c9019f3a9752a",
         "type": "github"
       },
       "original": {
@@ -398,9 +380,9 @@
         "type": "github"
       }
     },
-    "flake-utils_8": {
+    "flake-utils_7": {
       "inputs": {
-        "systems": "systems_9"
+        "systems": "systems_8"
       },
       "locked": {
         "lastModified": 1710146030,
@@ -466,11 +448,11 @@
         ]
       },
       "locked": {
-        "lastModified": 1711625603,
-        "narHash": "sha256-W+9dfqA9bqUIBV5u7jaIARAzMe3kTq/Hp2SpSVXKRQw=",
+        "lastModified": 1713391096,
+        "narHash": "sha256-5xkzsy+ILgQlmvDDipL5xqAehnjWBenAQXV4/NLg2dE=",
         "owner": "nix-community",
         "repo": "home-manager",
-        "rev": "c0ef0dab55611c676ad7539bf4e41b3ec6fa87d2",
+        "rev": "f46814ec7cbef9c2aef18ca1cbe89f2bb1e8c394",
         "type": "github"
       },
       "original": {
@@ -487,11 +469,11 @@
         ]
       },
       "locked": {
-        "lastModified": 1711625603,
-        "narHash": "sha256-W+9dfqA9bqUIBV5u7jaIARAzMe3kTq/Hp2SpSVXKRQw=",
+        "lastModified": 1712989663,
+        "narHash": "sha256-r2X/DIAyKOLiHoncjcxUk1TENWDTTaigRBaY53Cts/w=",
         "owner": "nix-community",
         "repo": "home-manager",
-        "rev": "c0ef0dab55611c676ad7539bf4e41b3ec6fa87d2",
+        "rev": "40ab43ae98cb3e6f07eaeaa3f3ed56d589da21b0",
         "type": "github"
       },
       "original": {
@@ -532,20 +514,21 @@
         "hyprland-protocols": "hyprland-protocols",
         "hyprlang": "hyprlang_2",
         "nixpkgs": "nixpkgs",
-        "systems": "systems_3",
+        "systems": "systems_2",
         "wlroots": "wlroots",
         "xdph": "xdph"
       },
       "locked": {
-        "lastModified": 1711768162,
-        "narHash": "sha256-TFXPKrAwobDQ13TyBwrc2W81RRisAG338CgNO7bLGuQ=",
+        "lastModified": 1711996237,
+        "narHash": "sha256-oa82eFINs1HkEnx3Nu+GEQQxXXNkJzSci3HZU//OJ2Y=",
         "owner": "hyprwm",
         "repo": "Hyprland",
-        "rev": "6fb8f502050c269597636c3b0bfcf046f7f6a947",
+        "rev": "3875679755014997776e091ff8903acfb311dd2f",
         "type": "github"
       },
       "original": {
         "owner": "hyprwm",
+        "ref": "v0.38.0",
         "repo": "Hyprland",
         "type": "github"
       }
@@ -582,7 +565,7 @@
           "hyprcursor",
           "nixpkgs"
         ],
-        "systems": "systems_2"
+        "systems": "systems"
       },
       "locked": {
         "lastModified": 1709914708,
@@ -637,15 +620,15 @@
     },
     "lib-aggregate": {
       "inputs": {
-        "flake-utils": "flake-utils_4",
+        "flake-utils": "flake-utils_3",
         "nixpkgs-lib": "nixpkgs-lib"
       },
       "locked": {
-        "lastModified": 1711282133,
-        "narHash": "sha256-s6z371miAZonduv53LQzjthvNCs4R+oTbv9cRu+iyL8=",
+        "lastModified": 1713105314,
+        "narHash": "sha256-X3URKbcgIy4UaQGrsy3DmY5x+fePQ5IYaa76YewoUE0=",
         "owner": "nix-community",
         "repo": "lib-aggregate",
-        "rev": "120535dff702c551ec76a125a181d90131407264",
+        "rev": "f347ed9a1cab12c27541ed4d173e2f2d5c9bc0bb",
         "type": "github"
       },
       "original": {
@@ -721,26 +704,6 @@
         "type": "github"
       }
     },
-    "nh": {
-      "inputs": {
-        "nixpkgs": [
-          "nixpkgs"
-        ]
-      },
-      "locked": {
-        "lastModified": 1710573382,
-        "narHash": "sha256-oGPasBk516A6pNE7iBEOmtrNsbqd+frR7O+z9lr1cLw=",
-        "owner": "viperML",
-        "repo": "nh",
-        "rev": "60c019a930e1718f1c5b6638f16dc221bf667d61",
-        "type": "github"
-      },
-      "original": {
-        "owner": "viperML",
-        "repo": "nh",
-        "type": "github"
-      }
-    },
     "nix-darwin": {
       "inputs": {
         "nixpkgs": [
@@ -823,11 +786,11 @@
     },
     "nixpkgs-lib": {
       "locked": {
-        "lastModified": 1711241261,
-        "narHash": "sha256-knrTvpl81yGFHIpm1SsLDApe0thFkw1cl3ISAMPmP/0=",
+        "lastModified": 1713055793,
+        "narHash": "sha256-vIrZQykYW32RnlI2lT/gCcB59BOIqqrAmPirBdiirrc=",
         "owner": "nix-community",
         "repo": "nixpkgs.lib",
-        "rev": "b2a1eeef8c185f6bd27432b053ff09d773244cbc",
+        "rev": "361d8a4f443bbfab20bd6d222f9022b8c6665906",
         "type": "github"
       },
       "original": {
@@ -838,11 +801,11 @@
     },
     "nixpkgs_2": {
       "locked": {
-        "lastModified": 1711703276,
-        "narHash": "sha256-iMUFArF0WCatKK6RzfUJknjem0H9m4KgorO/p3Dopkk=",
+        "lastModified": 1713248628,
+        "narHash": "sha256-NLznXB5AOnniUtZsyy/aPWOk8ussTuePp2acb9U+ISA=",
         "owner": "NixOS",
         "repo": "nixpkgs",
-        "rev": "d8fe5e6c92d0d190646fb9f1056741a229980089",
+        "rev": "5672bc9dbf9d88246ddab5ac454e82318d094bb8",
         "type": "github"
       },
       "original": {
@@ -870,11 +833,11 @@
     },
     "nixpkgs_4": {
       "locked": {
-        "lastModified": 1709294055,
-        "narHash": "sha256-7EECkQYoNKJZOf2+miJdrMpxpvsn/qZFwIhUI3fQpLs=",
+        "lastModified": 1713219115,
+        "narHash": "sha256-xC8H/s6ZBnqzJIf7gIV9OIL73d43pV60E8F2VOr5QRo=",
         "owner": "NixOS",
         "repo": "nixpkgs",
-        "rev": "ec869190b56a1b4677d24a8bdbcfe80ccea2ece6",
+        "rev": "2b80ce7707aedcb79be09e412b6dd6c15c578ab2",
         "type": "github"
       },
       "original": {
@@ -897,11 +860,11 @@
         "pre-commit-hooks": "pre-commit-hooks"
       },
       "locked": {
-        "lastModified": 1711806752,
-        "narHash": "sha256-Gl31XsjsTeccuNrjeR7eBQMLwuOWzryvLD3giGaK7TQ=",
+        "lastModified": 1713294906,
+        "narHash": "sha256-xJJZdCBzVFpVppaYyUK4lTTNOnbAxrjhodoJL3Oi91E=",
         "owner": "nix-community",
         "repo": "nixvim",
-        "rev": "6d1ef5864b6b3f7244f50847b6355b13ad8de3fd",
+        "rev": "514a51877df9fe41ffc38c5237e3c4e5327e7607",
         "type": "github"
       },
       "original": {
@@ -920,11 +883,11 @@
         ]
       },
       "locked": {
-        "lastModified": 1711786745,
-        "narHash": "sha256-3vyZvKs35aVzOa+/vRenR/052aapmxRH4L3+wh+wG2E=",
+        "lastModified": 1713424559,
+        "narHash": "sha256-aCQQBoi/PCFOrx1wgmalgF/ilL2aJpDzIdS0bG1+gfo=",
         "owner": "nix-community",
         "repo": "nixpkgs-wayland",
-        "rev": "11544449e6b696e209463aae094e736368eef757",
+        "rev": "b9dc634d9c3f2d79ff567b70e8ebc897b08f123b",
         "type": "github"
       },
       "original": {
@@ -935,7 +898,7 @@
     },
     "nvim": {
       "inputs": {
-        "flake-utils": "flake-utils_5",
+        "flake-utils": "flake-utils_4",
         "nixpkgs": [
           "nixpkgs"
         ]
@@ -1003,7 +966,7 @@
     "pre-commit-hooks": {
       "inputs": {
         "flake-compat": "flake-compat_2",
-        "flake-utils": "flake-utils_3",
+        "flake-utils": "flake-utils_2",
         "gitignore": "gitignore",
         "nixpkgs": [
           "nixvim",
@@ -1015,11 +978,11 @@
         ]
       },
       "locked": {
-        "lastModified": 1711760932,
-        "narHash": "sha256-DqUTQ2iAAqSDwMhKBqvi24v0Oc7pD3LCK/0FCG//TdA=",
+        "lastModified": 1712897695,
+        "narHash": "sha256-nMirxrGteNAl9sWiOhoN5tIHyjBbVi5e2tgZUgZlK3Y=",
         "owner": "cachix",
         "repo": "pre-commit-hooks.nix",
-        "rev": "c11e43aed6f17336c25cd120eac886b96c455731",
+        "rev": "40e6053ecb65fcbf12863338a6dcefb3f55f1bf8",
         "type": "github"
       },
       "original": {
@@ -1080,7 +1043,6 @@
         "hyprland": "hyprland",
         "mattermost-plugin-focalboard": "mattermost-plugin-focalboard",
         "mattermost-plugin-jitsi": "mattermost-plugin-jitsi",
-        "nh": "nh",
         "nixpkgs": "nixpkgs_2",
         "nixvim": "nixvim",
         "nixwaypkgs": "nixwaypkgs",
@@ -1118,11 +1080,11 @@
         ]
       },
       "locked": {
-        "lastModified": 1709259239,
-        "narHash": "sha256-MbrpgqpvUND7+UnOSLazrAMj0+zle16RRiOKTtjBefw=",
+        "lastModified": 1713233539,
+        "narHash": "sha256-dPGrCy5ttx6E3bUOmDynY/cAotRqvoIAimZlbv+Zr1w=",
         "owner": "oxalica",
         "repo": "rust-overlay",
-        "rev": "0e031ddb3f5a339dc6eda93d271ae43618b14eec",
+        "rev": "847bc25ebab8dc72a86d2b1f0c088740eebbb1b8",
         "type": "github"
       },
       "original": {
@@ -1157,16 +1119,16 @@
     },
     "systems": {
       "locked": {
-        "lastModified": 1681028828,
-        "narHash": "sha256-Vy1rq5AaRuLzOxct8nz4T6wlgyUR7zLU309k9mBC768=",
+        "lastModified": 1689347949,
+        "narHash": "sha256-12tWmuL2zgBgZkdoB6qXZsgJEH9LR3oUgpaQq2RbI80=",
         "owner": "nix-systems",
-        "repo": "default",
-        "rev": "da67096a3b9bf56a91d16901293e51ba5b49a27e",
+        "repo": "default-linux",
+        "rev": "31732fcf5e8fea42e59c2488ad31a0e651500f68",
         "type": "github"
       },
       "original": {
         "owner": "nix-systems",
-        "repo": "default",
+        "repo": "default-linux",
         "type": "github"
       }
     },
@@ -1187,16 +1149,16 @@
     },
     "systems_3": {
       "locked": {
-        "lastModified": 1689347949,
-        "narHash": "sha256-12tWmuL2zgBgZkdoB6qXZsgJEH9LR3oUgpaQq2RbI80=",
+        "lastModified": 1681028828,
+        "narHash": "sha256-Vy1rq5AaRuLzOxct8nz4T6wlgyUR7zLU309k9mBC768=",
         "owner": "nix-systems",
-        "repo": "default-linux",
-        "rev": "31732fcf5e8fea42e59c2488ad31a0e651500f68",
+        "repo": "default",
+        "rev": "da67096a3b9bf56a91d16901293e51ba5b49a27e",
         "type": "github"
       },
       "original": {
         "owner": "nix-systems",
-        "repo": "default-linux",
+        "repo": "default",
         "type": "github"
       }
     },
@@ -1275,21 +1237,6 @@
         "type": "github"
       }
     },
-    "systems_9": {
-      "locked": {
-        "lastModified": 1681028828,
-        "narHash": "sha256-Vy1rq5AaRuLzOxct8nz4T6wlgyUR7zLU309k9mBC768=",
-        "owner": "nix-systems",
-        "repo": "default",
-        "rev": "da67096a3b9bf56a91d16901293e51ba5b49a27e",
-        "type": "github"
-      },
-      "original": {
-        "owner": "nix-systems",
-        "repo": "default",
-        "type": "github"
-      }
-    },
     "treefmt": {
       "inputs": {
         "nixpkgs": [
@@ -1334,6 +1281,27 @@
         "type": "github"
       }
     },
+    "treefmt_2": {
+      "inputs": {
+        "nixpkgs": [
+          "fjo",
+          "nixpkgs"
+        ]
+      },
+      "locked": {
+        "lastModified": 1711803027,
+        "narHash": "sha256-Qic3OvsVLpetchzaIe2hJqgliWXACq2Oee6mBXa/IZQ=",
+        "owner": "numtide",
+        "repo": "treefmt-nix",
+        "rev": "1810d51a015c1730f2fe05a255258649799df416",
+        "type": "github"
+      },
+      "original": {
+        "owner": "numtide",
+        "repo": "treefmt-nix",
+        "type": "github"
+      }
+    },
     "wlroots": {
       "flake": false,
       "locked": {
@@ -1389,17 +1357,17 @@
     "zig": {
       "inputs": {
         "flake-compat": "flake-compat_4",
-        "flake-utils": "flake-utils_6",
+        "flake-utils": "flake-utils_5",
         "nixpkgs": [
           "nixpkgs"
         ]
       },
       "locked": {
-        "lastModified": 1711800454,
-        "narHash": "sha256-uanB/jYcVbIq9+K7n8Iom1+gADAW8T+AjK2x7XdtxOY=",
+        "lastModified": 1713399763,
+        "narHash": "sha256-iaRpxQEbruPiWKi71uxb7fgamPvX3KdetzSwTM/Acck=",
         "owner": "mitchellh",
         "repo": "zig-overlay",
-        "rev": "7bd8979683da11946fe29f7654567356ac3b1989",
+        "rev": "1c839c53ad6ce53895f59432378efb602be19796",
         "type": "github"
       },
       "original": {
@@ -1411,16 +1379,16 @@
     "zjstatus": {
       "inputs": {
         "crane": "crane_2",
-        "flake-utils": "flake-utils_7",
+        "flake-utils": "flake-utils_6",
         "nixpkgs": "nixpkgs_4",
         "rust-overlay": "rust-overlay_2"
       },
       "locked": {
-        "lastModified": 1711471490,
-        "narHash": "sha256-2iFDvbyLzAeytKywd/jqatd86sC6z0EcIwwe/fT+RJg=",
+        "lastModified": 1713354600,
+        "narHash": "sha256-/REaJdsq5b/VqLQhwrZ/talfLNqFP+kpgEnlLkic7TE=",
         "owner": "dj95",
         "repo": "zjstatus",
-        "rev": "a584399858437d64ae55c423454da48b6b8a0933",
+        "rev": "620786260b79c086ac06a0a17086499ace9d94f5",
         "type": "github"
       },
       "original": {
@@ -1431,7 +1399,7 @@
     },
     "zls": {
       "inputs": {
-        "flake-utils": "flake-utils_8",
+        "flake-utils": "flake-utils_7",
         "gitignore": "gitignore_2",
         "langref": "langref",
         "nixpkgs": [
@@ -1442,11 +1410,11 @@
         ]
       },
       "locked": {
-        "lastModified": 1711638151,
-        "narHash": "sha256-gQw23w4SDTMxDbhmetg2Y4PFLf1/73EkNvB6RfGN7qY=",
+        "lastModified": 1713428019,
+        "narHash": "sha256-sP8OYG0QHFcFACd16DUkL+3wW4mx1pgGDesiNjRyubU=",
         "owner": "zigtools",
         "repo": "zls",
-        "rev": "74e01ff9b4db17ac61e802788f007f0892abc421",
+        "rev": "6111cd0c68f725575836024a30237245ee37b8e0",
         "type": "github"
       },
       "original": {
diff --git a/flake.nix b/flake.nix
--- a/flake.nix
+++ b/flake.nix
@@ -13,7 +13,7 @@
     zls.inputs.zig-overlay.follows = "zig";
 
     ## Wayland
-    hyprland.url = "github:hyprwm/Hyprland";
+    hyprland.url = "github:hyprwm/Hyprland/v0.38.0";
     nixwaypkgs.url = "github:nix-community/nixpkgs-wayland";
     nixwaypkgs.inputs.nixpkgs.follows = "nixpkgs";
 
@@ -27,8 +27,6 @@
     ## Terminal
     fjo.url = "git+https://codeberg.org/VoiDD/fjo";
     fjo.inputs.nixpkgs.follows = "nixpkgs";
-    nh.url = "github:viperML/nh";
-    nh.inputs.nixpkgs.follows = "nixpkgs";
     zjstatus.url = "github:dj95/zjstatus";
 
     ## Mattermost
@@ -59,7 +57,7 @@
   #     [ "hyprland.cachix.org-1:a7pgxzMz7+chwVL3/pzj6jIBMioiJM7ypFP8PwtkuGc=" ];
   # };
 
-  outputs = { self, nixpkgs, home-manager, nixwaypkgs, nh, ... }@inputs:
+  outputs = { self, nixpkgs, home-manager, nixwaypkgs, ... }@inputs:
     let
       mkSystem = name:
         nixpkgs.lib.nixosSystem rec {
@@ -86,9 +84,10 @@
               nixpkgs.overlays =
                 [ (_: super: import ./src/pkgs { pkgs = super; }) ];
 
-              environment.systemPackages = [ nh.packages.${system}.default ];
-
-              environment.variables.FLAKE = "/home/ilya/dotfiles";
+              programs.nh = {
+                enable = true;
+                flake = "/home/ilya/dotfiles";
+              };
             }
           ];
         };
diff --git a/src/common/hyprdsl.nix b/src/common/hyprdsl.nix
--- a/src/common/hyprdsl.nix
+++ b/src/common/hyprdsl.nix
@@ -67,6 +67,7 @@
       (name: (arg1: arg2: (func name [ arg1 arg2 ])));
   in {
     centerwindow1 = func "centerwindow" [ 1 ];
+    exec = what: "exec,${what}";
   }
 
   // named [
@@ -91,8 +92,6 @@
   ]
 
   // singlearg [
-    "exec"
-    "execr"
     "pass"
     "closewindow"
     "workspace"
@@ -124,8 +123,8 @@
       else if lib.isString mods then
         mods
       else
-        lib.concatStringsSep " " mods
-    }, ${
+        lib.concatStringsSep "_" mods
+    },${
       if lib.isString keys then keys else lib.concatStringsSep " " keys
-    }, ${action}";
+    },${action}";
 }
diff --git a/src/home/default.nix b/src/home/default.nix
--- a/src/home/default.nix
+++ b/src/home/default.nix
@@ -14,6 +14,7 @@
     ../desktop/hypr.home.nix
     ../desktop/river.home.nix
 
+    ../programs/vcs.home.nix
     ../programs/terminal.home.nix
     ../programs/nvim.home.nix
   ];
diff --git a/src/nodes/minky.nix b/src/nodes/minky.nix
--- a/src/nodes/minky.nix
+++ b/src/nodes/minky.nix
@@ -1,7 +1,7 @@
 { pkgs, ... }: {
   imports = [
     ./minky.hardware.nix
-    ../os/services/mattermost.nix
+    # ../os/services/mattermost.nix
     ../os/services/agh.nix
   ];
   deployment = {
@@ -25,6 +25,7 @@
     git
     bat
     btop
+    mercurial
   ];
 
   services.cloudflared = {
@@ -32,7 +33,7 @@
     tunnels."b962a0e8-d103-4275-a301-4b40208de026" = {
       credentialsFile =
         "/var/lib/cloudflared/b962a0e8-d103-4275-a301-4b40208de026.json";
-      ingress."mm.matestmc.ru".service = "http://localhost:8065";
+      ingress."hg.matestmc.ru".service = "http://localhost:3080";
       default = "http_status:404";
     };
   };
@@ -48,4 +49,22 @@
   system.stateVersion = "24.05";
   services.openssh.enable = true;
   services.openssh.settings = { PermitRootLogin = "yes"; };
+  users.users.hg = {
+    isNormalUser = true;
+    openssh.authorizedKeys.keys = [
+      "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCnAcAQiO4tTvlpIu4PN2uWjDKr4/vOKkgFjb8UN4K74BO9Goa1nSqiiPaTGMUF0QZkeXo7KRJLyfUHt8HV/8udeVCaFywlzdje56MDkud1RFAAPa7FNFnYs62IbO2eGpODxnm7c/wRZJ4BEhL/RwBG85Rsb6CmB7/eWbrjUCJfUlG6Qta8V7mvPplXvV91dyoqymH5H/PXxGAMD/xOWOm4RjZFcj+o1mI8K2ilo/cDDQ+ZTyk0/vjkFBXlbURJA4xLp+rL2Fteo4LwMV6prHTOGoihYUeRYcRVJsNMQoTslyOsE+Q22yEj0r9w3uCbdAuF9BP4JO9Vls2pG3RjD85x minkyhg"
+    ];
+    home = "/srv/conical/repo";
+  };
+  systemd.services.hg-serve = {
+    enable = true;
+    description = "A systemd service for hg-serve";
+    serviceConfig = {
+      ExecStart = "${pkgs.mercurial}/bin/hg serve --web-conf ${pkgs.writeText "" ''
+        [paths]
+        / = /srv/conical/repo/**
+      ''} --port 3080 --config web.allow-archive=zip";
+    };
+    wantedBy = [ "multi-user.target" ];
+  };
 }
diff --git a/src/os/nvidia.nix b/src/os/nvidia.nix
--- a/src/os/nvidia.nix
+++ b/src/os/nvidia.nix
@@ -44,7 +44,7 @@
   hardware.nvidia = {
     modesetting.enable = true;
     open = false;
-    package = config.boot.kernelPackages.nvidiaPackages.production;
+    package = config.boot.kernelPackages.nvidiaPackages.vulkan_beta;
     nvidiaSettings = true;
   };
 }
diff --git a/src/programs/nvim.home.nix b/src/programs/nvim.home.nix
--- a/src/programs/nvim.home.nix
+++ b/src/programs/nvim.home.nix
@@ -287,6 +287,7 @@
         installCargo = false;
         installRustc = false;
         settings = {
+          cargo.extraEnv.RUSTFLAGS = "-Clink-arg=-fuse-ld=mold";
           cargo.features = "all";
           lens.enable = true;
           procMacro.ignored = {
diff --git a/src/programs/vcs.home.nix b/src/programs/vcs.home.nix
new file mode 100644
--- /dev/null
+++ b/src/programs/vcs.home.nix
@@ -0,0 +1,9 @@
+{ pkgs, ... }: {
+  programs.mercurial = {
+    enable = true;
+    extraConfig.extensions.convert = "";
+    package = pkgs.mercurialFull;
+    userEmail = "borodinov.ilya@gmail.com";
+    userName = "noth";
+  };
+}
